<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Терминал Горизонт Станции</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glow-color: rgba(0, 255, 100, 0.8);
            --alert-color: #ff5555;
        }
        
        body {
            background: radial-gradient(ellipse at center, #0a0e12 0%, #000000 100%);
            color: var(--glow-color);
            font-family: 'Ubuntu Mono', monospace;
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        .holographic-ui {
            background: rgba(10, 30, 20, 0.3);
            border: 1px solid var(--glow-color);
            box-shadow: 0 0 15px var(--glow-color);
            position: relative;
        }
        
        .holographic-ui::before {
            content: "";
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 1px solid var(--glow-color);
            filter: blur(5px);
            z-index: -1;
            pointer-events: none;
        }
        
        .data-stream {
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 255, 100, 0.1),
                rgba(0, 255, 100, 0.1) 1px,
                transparent 1px,
                transparent 4px
            );
        }
        
        .neon-alert {
            animation: neon-pulse 1.5s infinite alternate;
        }
        
        @keyframes neon-pulse {
            from { text-shadow: 0 0 5px var(--glow-color); }
            to { text-shadow: 0 0 15px var(--alert-color), 0 0 20px var(--alert-color); }
        }
        
        .neon-text {
            text-shadow: 0 0 5px var(--glow-color);
        }
        
        .neon-input {
            background: rgba(0, 20, 10, 0.5);
            border: 1px solid var(--glow-color);
            color: var(--glow-color);
            padding: 0.5rem;
            font-family: 'Ubuntu Mono', monospace;
            outline: none;
            box-shadow: 0 0 5px var(--glow-color);
        }
        
        .neon-input:focus {
            box-shadow: 0 0 10px var(--glow-color);
        }
        
        .dna-strand {
            display: flex;
            justify-content: center;
            height: 40px;
            position: relative;
            margin: 1rem 0;
        }
        
        .base-pair {
            width: 4px;
            height: 40px;
            background: var(--glow-color);
            position: absolute;
            transform-origin: bottom center;
            animation: dna-float 3s infinite ease-in-out;
            opacity: 0.8;
        }
        
        @keyframes dna-float {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(5deg); }
        }
        
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--glow-color);
            box-shadow: 0 0 10px var(--glow-color);
            animation: scan 3s linear infinite;
            opacity: 0;
        }
        
        @keyframes scan {
            0% { top: 0; opacity: 1; }
            100% { top: 100%; opacity: 1; }
        }
        
        .progress-bar-inner {
            height: 100%;
            background: linear-gradient(90deg, rgba(0,255,100,0.2), var(--glow-color));
            width: 0%;
            transition: width 1s ease;
        }
        
        .particle {
            position: absolute;
            background: var(--glow-color);
            border-radius: 50%;
            pointer-events: none;
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="holographic-ui w-full max-w-4xl rounded-lg overflow-hidden data-stream">
        <!-- Scan line effect -->
        <div class="scan-line"></div>
        
        <!-- Terminal header -->
        <div class="border-b border-green-500 p-4 flex justify-between items-center">
            <div class="flex items-center">
                <div class="w-3 h-3 rounded-full bg-red-500 mr-2"></div>
                <div class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
            </div>
            <h1 class="text-xl neon-text">ТЕРМИНАЛ СТАНЦИИ "ГОРИЗОНТ" v2.4.7</h1>
            <div class="text-sm">[УРОВЕНЬ ДОСТУПА: <span class="text-yellow-400">3</span>]</div>
        </div>
        
        <!-- Main terminal content -->
        <div class="p-4 md:p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Left column - Auth panel -->
            <div class="holographic-ui p-4 rounded col-span-1">
                <div class="neon-alert text-center mb-4 font-bold">ТРЕБУЕТСЯ АУТЕНТИФИКАЦИЯ</div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block mb-1">ИДЕНТИФИКАТОР АГЕНТА:</label>
                        <input type="text" class="neon-input w-full" id="agent-id" placeholder="ID-XXXXXX">
                        <div class="text-xs mt-1 text-green-300" id="id-hint"></div>
                    </div>
                    
                    <div>
                        <label class="block mb-1">КОД ДОСТУПА:</label>
                        <input type="password" class="neon-input w-full" id="access-code" placeholder="••••••••">
                    </div>
                    
                    <div class="text-center">
                        <button onclick="attemptLogin()" class="bg-green-900 bg-opacity-50 border border-green-500 px-4 py-2 rounded hover:bg-opacity-70 transition-all hover:shadow-lg hover:shadow-green-500/20">
                            ПОДТВЕРДИТЬ ДОСТУП
                        </button>
                    </div>
                </div>
                
                <!-- Biometric scanner -->
                <div class="mt-6 text-center">
                    <p class="mb-2">ИЛИ</p>
                    <button onclick="startBiometricScan()" class="text-xs bg-black bg-opacity-30 border border-green-500 px-3 py-1 rounded flex items-center mx-auto">
                        <span class="inline-block w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></span>
                        БИОМЕТРИЧЕСКОЕ СКАНИРОВАНИЕ
                    </button>
                    
                    <div class="dna-strand mt-2" id="dna-strand">
                        <!-- DNA pairs will be generated by JS -->
                    </div>
                    
                    <p class="text-xs mt-2">DNA MATCH: <span id="dna-match">0%</span></p>
                </div>
            </div>
            
            <!-- Middle column - Status and logs -->
            <div class="col-span-1 md:col-span-2 space-y-4">
                <!-- System status -->
                <div class="holographic-ui p-4 rounded">
                    <h2 class="text-lg font-bold mb-2 border-b border-green-500 pb-1">СОСТОЯНИЕ СИСТЕМЫ</h2>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div>КОНТЕЙНМЕНТ: <span class="text-green-400">СТАБИЛЕН</span></div>
                        <div>ЭНЕРГИЯ: <span class="text-yellow-400">87%</span></div>
                        <div>КАРАНТИН: <span class="text-red-400">АКТИВЕН</span></div>
                        <div>ОБРАЗЦЫ: <span class="text-red-400">12</span></div>
                    </div>
                    
                    <div class="mt-3">
                        <div class="flex justify-between text-xs mb-1">
                            <span>КОНТЕЙНМЕНТ Z9</span>
                            <span>72%</span>
                        </div>
                        <div class="w-full bg-gray-900 h-2 rounded-full overflow-hidden">
                            <div class="progress-bar-inner h-full" style="width: 72%"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Recent logs -->
                <div class="holographic-ui p-4 rounded">
                    <h2 class="text-lg font-bold mb-2 border-b border-green-500 pb-1">ПОСЛЕДНИЕ СОБЫТИЯ</h2>
                    <div class="text-sm space-y-2 max-h-40 overflow-y-auto pr-2">
                        <div class="flex">
                            <span class="text-gray-400">[08:42:17]</span>
                            <span class="ml-2">
Образец Z9-03 демонстрирует повышенную активность</span>
                        </div>
                        <div class="flex">
                            <span class="text-gray-400">[08:39:55]</span>
                            <span class="ml-2">Нарушение безопасности в секторе 4-Б</span>
                        </div>
                        <div class="flex">
                            <span class="text-gray-400">[08:37:23]</span>
                            <span class="ml-2">Инициированы протоколы сдерживания</span>
                        </div>
                        <div class="flex">
                            <span class="text-gray-400">[08:35:41]</span>
                            <span class="ml-2">Предупреждение: обнаружены колебания мощности</span>
                        </div>
                        <div class="flex">
                            <span class="text-gray-400">[08:32:09]</span>
                            <span class="ml-2">
Доктор Чен получил доступ к Лаборатории 3</span>
                        </div>
                    </div>
                </div>
                
                <!-- Mini-games selector -->
                <div class="holographic-ui p-4 rounded mt-4">
                    <h2 class="text-lg font-bold mb-2 border-b border-green-500 pb-1">ИНСТРУМЕНТЫ ВЗЛОМА</h2>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <button onclick="startGame('cipher')" class="bg-green-900 bg-opacity-50 border border-green-500 p-2 rounded hover:bg-opacity-70">
                            ДЕШИФРАТОР
                        </button>
                        <button onclick="startGame('wires')" class="bg-green-900 bg-opacity-50 border border-green-500 p-2 rounded hover:bg-opacity-70">
                            ПЕРЕПОДКЛЮЧЕНИЕ
                        </button>
                        <button onclick="startGame('puzzle')" class="bg-green-900 bg-opacity-50 border border-green-500 p-2 rounded hover:bg-opacity-70">
                            ГОЛОВОЛОМКА
                        </button>
                        <button onclick="startGame('morse')" class="bg-green-900 bg-opacity-50 border border-green-500 p-2 rounded hover:bg-opacity-70">
                            МОРЗЕ
                        </button>
                    </div>
                    <div id="game-container" class="mt-4"></div>
                </div>

                <!-- Agent-specific tools and chat -->
                <div id="agent-tools" class="holographic-ui p-4 rounded mt-4 hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h2 class="text-lg font-bold mb-2 border-b border-green-500 pb-1">ЛИЧНЫЕ ИНСТРУМЕНТЫ</h2>
                            <div id="tool-buttons" class="grid grid-cols-1 gap-2 text-sm"></div>
                        </div>
                        <div>
                            <h2 class="text-lg font-bold mb-2 border-b border-green-500 pb-1">СВЯЗЬ С АГЕНТАМИ</h2>
                            <div class="holographic-ui p-2 rounded mb-2 h-40 overflow-y-auto" id="chat-messages"></div>
                            <div class="flex">
                                <select id="chat-recipient" class="neon-input bg-black bg-opacity-50 mr-2">
                                    <option value="">Выберите агента</option>
                                    <option value="GOTYNYRI">Разработчик Gotynyri</option>
                                    <option value="IGOR-K7">Др. Игорь</option>
                                    <option value="OLES-Y4">Др. Олеся</option>
                                    <option value="DMIT-R9">Др. Дмитрий</option>
                                    <option value="AKIRA-42">Др. Акира</option>
                                    <option value="NICH-666">Николай</option>
                                    <option value="TOCHA-MK">Тоша</option>
                                </select>
                                <input type="text" class="neon-input flex-grow mr-2" id="chat-message" placeholder="Введите сообщение...">
                                <button onclick="sendChatMessage()" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded text-sm">
                                    ОТПРАВИТЬ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Command input -->
                <div class="holographic-ui p-4 rounded">
                    <h2 class="text-lg font-bold mb-2 border-b border-green-500 pb-1">ПРЯМАЯ КОМАНДА</h2>
                    <div class="flex">
                        <span class="text-green-400 mr-2">></span>
                        <input type="text" class="neon-input flex-grow bg-transparent" id="command-input" placeholder="Введите команду...">
                        <button onclick="executeCommand()" class="ml-2 bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded text-sm">
                            ВВОД
                        </button>
                    </div>
                    <div id="command-output" class="text-xs mt-2 h-20 overflow-y-auto"></div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="border-t border-green-500 p-3 text-xs flex justify-between">
            <div>ОБНОВЛЕНО: <span id="current-time">--:--:--</span></div>
            <div>СТАТУС: <span class="text-green-400">ОНЛАЙН</span></div>
            <div>ВЕРСИЯ: 2.4.7-ALPHA</div>
        </div>
    </div>

    <script>
        // Update current time
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString();
            document.getElementById('current-time').textContent = timeStr;
        }
        setInterval(updateTime, 1000);
        updateTime();
        
        // Create DNA strand visualization
        function createDNAStrand() {
            const container = document.getElementById('dna-strand');
            container.innerHTML = '';
            
            for (let i = 0; i < 12; i++) {
                const pair = document.createElement('div');
                pair.className = 'base-pair';
                pair.style.left = `${i * 8}px`;
                pair.style.animationDelay = `${i * 0.2}s`;
                
                // Random height variation
                const height = 20 + Math.random() * 20;
                pair.style.height = `${height}px`;
                
                // Color variation
                const hue = 100 + Math.random() * 30 - 15;
                pair.style.background = `hsl(${hue}, 100%, 50%)`;
                
                container.appendChild(pair);
            }
        }
        createDNAStrand();
        
        // Biometric scan simulation with DNA patterns
        function startBiometricScan() {
            const matchDisplay = document.getElementById('dna-match');
            let progress = 0;
            const dnaPatterns = ['GATTACA-42', 'TOCHA-MK1', 'NICH-XX7'];
            
            const scanInterval = setInterval(() => {
                progress += Math.random() * 8;
                if (progress > 100) progress = 100;
                matchDisplay.textContent = `${Math.floor(progress)}%`;
                
                if (progress === 100) {
                    clearInterval(scanInterval);
                    const randomPattern = dnaPatterns[Math.floor(Math.random() * dnaPatterns.length)];
                    let accessMessage = '';
                    
                    switch(randomPattern) {
                        case 'GATTACA-42':
                            accessMessage = 'ВНИМАНИЕ: ОБНАРУЖЕН ОБРАЗЕЦ Z9\nВключены карантинные протоколы';
                            break;
                        case 'TOCHA-MK1':
                            accessMessage = 'СООТВЕТСТВИЕ: ДО ЗАРАЖЕНИЯ ТОША\nДоступ к медицинским записям предоставлен';
                            break;
                        case 'NICH-XX7':
                            accessMessage = 'ОБНАРУЖЕНА АНОМАЛИЯ\nРаспознан шаблон Николаса\nТРЕВОГА: Ограниченный доступ';
                            break;
                    }
                    
                    setTimeout(() => {
                        alert(`BIOMETRIC SCAN COMPLETE\nDNA PATTERN: ${randomPattern}\n${accessMessage}`);
                    }, 500);
                }
            }, 200);
        }
        
        // Login attempt
        function attemptLogin() {
            const agentId = document.getElementById('agent-id').value;
            const accessCode = document.getElementById('access-code').value;
            
            if (!agentId || !accessCode) {
                alert('ОШИБКА: Введите идентификатор агента и код доступа');
                return;
            }
            
            // Agent-code pairs with special access, tools and chat responses
            const agentCodes = {
                'IGOR-K7': {
                    code: 'Z9-OMEGA',
                    name: 'Доктор Игорь Владимирович',
                    access: 'Протокол "Ковчег"',
                    tools: [
                        {name: 'Активировать Ковчег', func: 'launchProtocol("ARK")'},
                        {name: 'Журналы карантина', func: 'showQuarantineLogs()'},
                        {name: 'Системы отмены', func: 'overrideSystems()'}
                    ],
                    responses: [
                        "Я занят протоколами сдерживания.",
                        "Особи становятся более агрессивными.",
                        "Нам необходимо как можно скорее запустить протокол «Ковчег»."
                    ]
                },
                'OLES-Y4': {
                    code: 'CRYPT-704',
                    name: 'Доктор Олеся Миронова',
                    access: 'Биометрические данные экипажа',
                    tools: [
                        {name: 'Медицинское сканирование', func: 'medicalScan()'},
                        {name: 'Биометрические данные', func: 'showBiometrics()'},
                        {name: 'Карта заражения', func: 'showInfectionMap()'}
                    ],
                    responses: [
                        "Инфекция распространяется быстрее, чем ожидалось.",
                        "Жизненно важные показатели Тоши нестабильны.",
                        "Я анализирую последние образцы крови.",
                        "Скорость мутаций просто зашкаливает!",
                        "Мы теряем изоляцию в медицинском отсеке."
                    ],
                    blocked: false,
                    blockAfter: 4,
                    blockMessage: "ALERT: Medical quarantine - comms offline"
                },
                'DMIT-R9': {
                    code: 'TITAN-DM',
                    name: 'Доктор Дмитрий Соколов',
                    access: 'Чертежи вентиляции',
                    tools: [
                        {name: 'Вентиляционное управление', func: 'ventControl()'},
                        {name: 'Структурное сканирование', func: 'structuralScan()'},
                        {name: 'Аварийная печать', func: 'emergencySeal()'}
                    ],
                    responses: [
                        "Система вентиляции вышла из строя.",
                        "Сектор 4-Б в настоящее время полностью изолирован.",
                        "Я перенаправляю энергию на сдерживание."
                    ]
                },
                'AKIRA-42': {
                    code: 'GENOME-11',
                    name: 'Доктор Акира Танака',
                    access: 'Исследование ДНК Тоши',
                    tools: [
                        {name: 'Анализ ДНК', func: 'dnaAnalysis()'},
                        {name: 'Мутационный симулятор', func: 'mutationSim()'},
                        {name: 'Генная терапия', func: 'geneTherapy()'}
                    ],
                    responses: [
                        "Штамм Z9 демонстрирует беспрецедентную скорость мутаций.",
                        "ДНК Тоши содержит ключ к излечению.",
                        "Нам нужно больше времени для анализа."
                    ]
                },
                'NICH-666': {
                    code: 'NECRON-4',
                    name: 'Николас (Неизвестно)',
                    access: 'Древние тексты Z-9',
                    tools: [
                        {name: 'Древние тексты', func: 'showAncientTexts()'},
                        {name: 'Ритуальный круг', func: 'drawRitualCircle()'},
                        {name: 'Сканирование Бездны', func: 'voidScan()'}
                    ],
                    responses: [
                        "Старые пробуждаются.",
                        "Вы не понимаете, что мы выпустили на волю.",
                        "Сдерживание не будет сдерживать их вечно."
                    ]
                },
                'TOCHA-MK': {
                    code: 'PURGE-ALL',
                    name: 'Тоша (Заражённый)',
                    access: 'Последние моменты станции',
                    tools: [
                        {name: 'Системы очистки', func: 'purgeSystems'},
                        {name: 'Выпуск Z9', func: 'releaseZ9()'},
                        {name: 'Последнее сообщение', func:'showFinalMessage()'}
                    ],
                    responses: [
                        "Это уже внутри меня...",
                        "Боль... она повсюду...",
                        "Убей меня... пока не стало слишком поздно..."
                    ]
                },
                'GOTYNYRI': {
                    code: 'DEV-ACCESS-777',
                    name: 'Разработчик Gotynyri',
                    access: 'Полный системный доступ',
                    tools: [
                        {name: 'Редактировать систему', func: 'editSystem()'},
                        {name: 'Добавить агента', func: 'addAgent()'},
                        {name: 'Сбросить систему', func: 'resetSystem()'},
                        {name: 'Экспорт данных', func: 'exportAllData()'}
                    ],
                    responses: [
                        "Я контролирую систему.",
                        "Доступ к ядру разрешен.",
                        "Все протоколы под моим наблюдением."
                    ],
                    isDeveloper: true
                }
            };

            if (agentCodes[agentId] && accessCode === agentCodes[agentId].code) {
                const agent = agentCodes[agentId];
                alert(`ДОСТУП РАЗРЕШЁН\nС возвращением, ${agent.name}\nДоступ: ${agent.access}`);
                
                // Show agent-specific tools
                const toolsContainer = document.getElementById('agent-tools');
                toolsContainer.classList.remove('hidden');
                
                const buttonsContainer = document.getElementById('tool-buttons');
                buttonsContainer.innerHTML = '';
                
                // Add custom buttons
                agent.tools.forEach(tool => {
                    const button = document.createElement('button');
                    button.className = 'bg-green-900 bg-opacity-50 border border-green-500 p-2 rounded hover:bg-opacity-70';
                    button.textContent = tool.name;
                    button.onclick = new Function(tool.func);
                    buttonsContainer.appendChild(button);
                });
            } else {
                alert('ДОСТУП ЗАПРЕЩЁН\nНеверные учетные данные\nПопытка зафиксирована');
            }
        }
        
        // Command execution
        function executeCommand() {
            const commandInput = document.getElementById('command-input');
            const command = commandInput.value.trim();
            const output = document.getElementById('command-output');
            
            if (!command) return;
            
            // Add command to output
            output.innerHTML += `<div class="text-green-400">> ${command}</div>`;
            
            // Process command
            let response = '';
            
            switch(command.toUpperCase()) {
                // Основные команды
                case 'ПОМОЩЬ':
                    response = 'Доступные команды:\nстатус - состояние системы\nлоги - последние события\nсканирование - проверка систем\nразблокировать - доступ к секторам\nкамеры - просмотр камер\nрежим - изменить режим работы\nжурнал - полный журнал событий\nочистить - очистить терминал';
                    break;
                case 'СТАТУС':
                    response = 'Статус системы: ОНЛАЙН\nКонтеймент: 72%\nЭнергия: 87%\nКарантин: АКТИВЕН\nПерсонал: 12/24\nБезопасность: УРОВЕНЬ 3';
                    break;
                case 'ЛОГИ':
                    response = 'Последние 5 событий:\n[08:42:17] Активность образца Z9-03\n[08:39:55] Нарушение безопасности в секторе 4-Б\n[08:37:23] Инициирован контеймент\n[08:35:41] Колебания мощности\n[08:32:09] Доступ к Лаборатории 3';
                    break;
                case 'СКАНИРОВАНИЕ':
                    response = 'Запуск сканирования...\nСканирование завершено:\nОбнаружено 3 аномалии\n12 активных образцов\n4 незапечатанных шлюза';
                    break;
                case 'РАЗБЛОКИРОВАТЬ':
                    response = 'ОШИБКА: Требуется уровень доступа 4+';
                    break;
                case 'КАМЕРЫ':
                    response = 'Доступные камеры:\n1. Главный коридор\n2. Лаборатория 3\n3. Медотсек\n4. Сектор 4-Б (ОФФЛАЙН)\n5. Хранилище Z9\nВведите номер для просмотра';
                    break;
                case 'РЕЖИМ':
                    response = 'Доступные режимы:\n1. Стандартный\n2. Энергосбережение\n3. Карантин\n4. Аварийный\nВведите номер режима';
                    break;
                case 'ЖУРНАЛ':
                    response = 'Загрузка полного журнала...\nПоследние 24 часа доступны\nИспользуйте фильтры для поиска';
                    break;
                case 'ОЧИСТИТЬ':
                    document.getElementById('command-output').innerHTML = '';
                    return;
                
                // Tier 1 Story Codes
                case 'A9B2C7':
                    response = 'ДОСТУП К ГЛАВНОМУ АРХИВУ...\nЗагрузка чертежей станции';
                    break;
                case 'Z9M-7043':
                    response = 'СХЕМЫ БИОЛАБОРАТОРИИ РАЗБЛОКИРОВАНЫ\nПредупреждение: обнаружено нарушение условий содержания';
                    break;
                case 'HORIZON-X':
                    response = 'РАСШИФРОВАНЫ ВИДЕОЖУРНАЛЫ ЭКИПАЖА\nВоспроизведение файла: log_igor_7.avi';
                    break;
                case 'TITAN-24':
                    response = 'КАРТА ИНФЕКЦИИ ТИТАНА ЗАГРУЖЕНА\n3 активные зоны вспышки';
                    break;
                case 'TOCHA-11':
                    response = 'ДОСТУП К МЕДИЦИНСКИМ ДОКУМЕНТАМ\nАнализ крови показывает маркеры Z9';
                    break;
                
                // Emergency Codes
                case 'RED-ALPHA':
                    response = 'АКТИВИРОВАН ПРОТОКОЛ КАРАНТИНА\nВсе сектора запечатаны...';
                    break;
                case 'OMEGA-9':
                    response = 'САМОУНИЧТОЖЕНИЕ ЗАПУЩЕНО\n30 секунд до детонации';
                    break;
                
                // Easter Eggs
                case 'UPUP-DOWN':
                    response = 'РЕЖИМ РЕТРО ВКЛЮЧЕН\nОтображение 8-битного интерфейса';
                    break;
                case 'NEO-MATRIX':
                    response = 'СИСТЕМНОЕ ПЕРЕОПРЕДЕЛЕНИЕ\nАктивирован зеленый поток данных';
                    break;
                
                default:
                    response = `ОШИБКА: Неизвестная команда "${command}"`;
            }
            
            output.innerHTML += `<div class="text-gray-300">${response}</div>`;
            output.scrollTop = output.scrollHeight;
            commandInput.value = '';
        }
        
        // Allow pressing Enter in command input
        document.getElementById('command-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                executeCommand();
            }
        });
        
        // Create floating particles
        function createParticles() {
            const colors = ['rgba(0,255,100,0.5)', 'rgba(0,200,80,0.3)', 'rgba(0,150,60,0.2)'];
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Random properties
                const size = Math.random() * 3 + 1;
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.background = color;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Animation
                const duration = Math.random() * 20 + 10;
                particle.style.animation = `float ${duration}s linear infinite`;
                particle.style.animationDelay = `${Math.random() * 5}s`;
                
                document.body.appendChild(particle);
            }
        }
        
        // Generate daily code
        function generateDailyCode() {
            const now = new Date();
            const day = now.getDate().toString().padStart(2, '0');
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            return `CRYPT-${month}${day}`;
        }

        // Agent ID hints
        const hintsDatabase = {
            "IGOR-K7": "Код начинается с Z9-... (выгравирован на табличке)",
            "OLES-Y4": "Скрыто в аудиодневнике (обратный звук)",
            "DMIT-R9": "Написано на обороте фотографии Титана.",
            "AKIRA-42": "Зашифровано в японском хокку (анаграмма)",
            "NICH-666": "Скрытые в татуировках символы",
            "TOCHA-MK": "Продиктовано в трансе (Аудио с азбукой Морзе)"
        };

        document.getElementById('agent-id').addEventListener('input', function() {
            document.getElementById('id-hint').textContent = hintsDatabase[this.value] || "";
        });

        // Mini-games framework
        function startGame(gameType) {
            const container = document.getElementById('game-container');
            container.innerHTML = '';
            
            switch(gameType) {
                case 'cipher':
                    container.innerHTML = `
                        <div class="holographic-ui p-4 rounded">
                            <h3 class="font-bold mb-2">// ДЕШИФРАТОР //</h3>
                            <p>Зашифрованное сообщение: <span class="text-yellow-400">ZKDW GR BRX VHH</span></p>
                            <div class="flex items-center mt-2">
                                <button onclick="shiftCipher(-1)" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded">
                                    ←
                                </button>
                                <span class="mx-4" id="shift-value">Сдвиг: 0</span>
                                <button onclick="shiftCipher(1)" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded">
                                    →
                                </button>
                            </div>
                            <p class="mt-2">Расшифровка: <span id="decoded-text">?????????</span></p>
                            <button onclick="checkCipherSolution()" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded mt-2 hidden" id="cipher-submit">
                                ПРОВЕРИТЬ
                            </button>
                        </div>
                    `;
                    break;
                case 'wires':
                    container.innerHTML = `
                        <div class="holographic-ui p-4 rounded">
                            <h3 class="font-bold mb-2">// ПЕРЕПОДКЛЮЧЕНИЕ //</h3>
                            <p>Выберите правильную последовательность:</p>
                            <div class="grid grid-cols-3 gap-2 mt-2">
                                <button onclick="selectWire(1)" class="bg-red-500 h-8"></button>
                                <button onclick="selectWire(2)" class="bg-blue-500 h-8"></button>
                                <button onclick="selectWire(3)" class="bg-green-500 h-8"></button>
                                <button onclick="selectWire(4)" class="bg-yellow-500 h-8"></button>
                                <button onclick="selectWire(5)" class="bg-purple-500 h-8"></button>
                                <button onclick="selectWire(6)" class="bg-white h-8"></button>
                            </div>
                            <p class="mt-2">Выбрано: <span id="wire-sequence"></span></p>
                            <button onclick="checkWireSolution()" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded mt-2">
                                ПРОВЕРИТЬ
                            </button>
                        </div>
                    `;
                    break;
                case 'puzzle':
                    container.innerHTML = `
                        <div class="holographic-ui p-4 rounded">
                            <h3 class="font-bold mb-2">// ГОЛОВОЛОМКА //</h3>
                            <p>Решите уравнение: 7 _ 3 _ 5 = 26</p>
                            <div class="flex space-x-2 mt-2">
                                <select id="operator1" class="neon-input">
                                    <option>+</option>
                                    <option>-</option>
                                    <option>*</option>
                                    <option>/</option>
                                </select>
                                <select id="operator2" class="neon-input">
                                    <option>+</option>
                                    <option>-</option>
                                    <option>*</option>
                                    <option>/</option>
                                </select>
                            </div>
                            <button onclick="checkPuzzleSolution()" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded mt-2">
                                ПРОВЕРИТЬ
                            </button>
                        </div>
                    `;
                    break;
                case 'morse':
                    container.innerHTML = `
                        <div class="holographic-ui p-4 rounded">
                            <h3 class="font-bold mb-2">// МОРЗЕ //</h3>
                            <p>Расшифруйте: ... --- ...</p>
                            <input type="text" id="morse-input" class="neon-input w-full mt-2" placeholder="Введите расшифровку">
                            <button onclick="checkMorseSolution()" class="bg-green-900 bg-opacity-50 border border-green-500 px-3 py-1 rounded mt-2">
                                ПРОВЕРИТЬ
                            </button>
                        </div>
                    `;
                    break;
            }
        }

        // Cipher game functions
        function decodeCaesar(text, shift) {
            return text.split('').map(c => {
                if (c.match(/[A-Z]/)) {
                    const code = c.charCodeAt(0);
                    return String.fromCharCode(((code - 65 + shift) % 26 + 26) % 26 + 65);
                }
                return c;
            }).join('');
        }

        function shiftCipher(step) {
            currentShift = (currentShift + step) % 26;
            document.getElementById('shift-value').textContent = `Shift: ${currentShift}`;
            const decoded = decodeCaesar("ZKDW GR BRX VHH", currentShift);
            document.getElementById('decoded-text').textContent = decoded;
            if(decoded === "WHAT DO YOU SEE") {
                document.getElementById('cipher-submit').classList.remove('hidden');
            }
        }

        function checkCipherSolution() {
            const output = document.getElementById('command-output');
            output.innerHTML += `<div class="text-green-400">Cipher solved! Access code fragment: OL-ES</div>`;
            output.scrollTop = output.scrollHeight;
            document.getElementById('game-container').innerHTML = '';
        }

        let currentShift = 0;
        let wireSequence = [];
        
        function selectWire(wireNum) {
            wireSequence.push(wireNum);
            document.getElementById('wire-sequence').textContent = wireSequence.join(', ');
        }
        
        function checkWireSolution() {
            const output = document.getElementById('command-output');
            if(wireSequence.join('') === '352') {
                output.innerHTML += `<div class="text-green-400">Wire sequence correct! Access code fragment: YA-4</div>`;
            } else {
                output.innerHTML += `<div class="text-red-400">Incorrect sequence! Try again.</div>`;
            }
            output.scrollTop = output.scrollHeight;
            wireSequence = [];
            document.getElementById('wire-sequence').textContent = '';
        }
        
        function checkPuzzleSolution() {
            const op1 = document.getElementById('operator1').value;
            const op2 = document.getElementById('operator2').value;
            const output = document.getElementById('command-output');
            
            try {
                const result = eval(`7 ${op1} 3 ${op2} 5`);
                if(result === 26) {
                    output.innerHTML += `<div class="text-green-400">Puzzle solved! Access code fragment: 7${op1}3${op2}5</div>`;
                } else {
                    output.innerHTML += `<div class="text-red-400">Incorrect solution (${result}). Try again.</div>`;
                }
            } catch {
                output.innerHTML += `<div class="text-red-400">Invalid equation</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }
        
        function checkMorseSolution() {
            const answer = document.getElementById('morse-input').value.toUpperCase();
            const output = document.getElementById('command-output');
            
            if(answer === 'SOS') {
                output.innerHTML += `<div class="text-green-400">Morse decoded! Access code fragment: SOS-</div>`;
            } else {
                output.innerHTML += `<div class="text-red-400">Incorrect decoding. Try again.</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Agent tool functions
        function launchProtocol(protocol) {
            alert(`Launching ${protocol} protocol...\nAuthorization required`);
        }
        
        function overrideSystems() {
            document.getElementById('command-output').innerHTML += 
                '<div class="text-red-400">WARNING: System override initiated!</div>';
        }
        
        function showQuarantineLogs() {
            document.getElementById('game-container').innerHTML = `
                <div class="holographic-ui p-4 rounded">
                    <h3>QUARANTINE LOGS</h3>
                    <p>Z9-01: Contained</p>
                    <p>Z9-02: Escaped</p>
                    <p>Z9-03: Mutating</p>
                </div>`;
        }
        
        // Новые функции на русском
        function showCameras() {
            const output = document.getElementById('command-output');
            output.innerHTML += `
                <div class="text-green-400">ДОСТУП К КАМЕРАМ:</div>
                <div class="grid grid-cols-2 gap-2 mt-2">
                    <div class="holographic-ui p-2 text-center">КАМЕРА 1<br>Главный коридор</div>
                    <div class="holographic-ui p-2 text-center">КАМЕРА 2<br>Лаборатория 3</div>
                    <div class="holographic-ui p-2 text-center">КАМЕРА 3<br>Медотсек</div>
                    <div class="holographic-ui p-2 text-center text-red-400">КАМЕРА 4<br>ОФФЛАЙН</div>
                </div>
            `;
            output.scrollTop = output.scrollHeight;
        }

        function checkSensors() {
            const output = document.getElementById('command-output');
            output.innerHTML += `
                <div class="text-green-400">СОСТОЯНИЕ ДАТЧИКОВ:</div>
                <div class="text-sm mt-2">
                    <div>Датчики движения: <span class="text-green-400">НОРМА</span></div>
                    <div>Биодатчики: <span class="text-yellow-400">АНОМАЛИЯ</span></div>
                    <div>Датчики давления: <span class="text-green-400">НОРМА</span></div>
                    <div>Термодатчики: <span class="text-red-400">ПЕРЕГРЕВ</span></div>
                </div>
            `;
            output.scrollTop = output.scrollHeight;
        }

        function systemDiagnostics() {
            const output = document.getElementById('command-output');
            output.innerHTML += `
                <div class="text-green-400">ДИАГНОСТИКА СИСТЕМ:</div>
                <div class="text-sm mt-2">
                    <div>1. Проверка энергосистем... <span class="text-green-400">OK</span></div>
                    <div>2. Проверка вентиляции... <span class="text-yellow-400">ОШИБКА</span></div>
                    <div>3. Проверка шлюзов... <span class="text-red-400">СБОЙ</span></div>
                    <div>4. Проверка связи... <span class="text-green-400">OK</span></div>
                    <div>5. Проверка безопасности... <span class="text-yellow-400">ПРЕДУПРЕЖДЕНИЕ</span></div>
                </div>
            `;
            output.scrollTop = output.scrollHeight;
        }

        // Функции разработчика
        function editSystem() {
            const password = prompt("Введите пароль разработчика:");
            if (password === "Z9-Dev-Secure-777") {
                const newCode = prompt("Введите новый код системы:");
                if (newCode) {
                    alert(`Код системы изменен на:\n${newCode}\nИзменения применены глобально`);
                    // In real system would update all users
                }
            } else {
                alert("Неверный пароль разработчика");
            }
        }
        
        function addAgent() {
            const id = prompt("Введите ID нового агента:");
            const code = prompt("Введите код доступа:");
            if(id && code) {
                alert(`Новый агент добавлен:\nID: ${id}\nКод: ${code}`);
            }
        }
        
        function resetSystem() {
            if(confirm("Вы уверены что хотите сбросить систему?")) {
                alert("Сброс системы...\nВсе настройки восстановлены");
            }
        }

        // Функции других инструментов...
        function medicalScan() { alert("Запуск медицинского сканирования..."); }
        function showBiometrics() { alert("Отображаются биометрические данные"); }
        function showInfectionMap() { alert("Загрузка карты заражения"); }
        function ventControl() { alert("Управление вентиляцией"); }
        function structuralScan() { alert("Структурное сканирование запущено"); }
        function emergencySeal() { alert("Аварийная пломба активирована"); }
        function dnaAnalysis() { alert("Анализ ДНК начался"); }
        function mutationSim() { alert("Моделирование мутаций"); }
        function geneTherapy() { alert("Протоколы генной терапии"); }
        function showAncientTexts() { alert("Древние тексты доступны"); }
        function drawRitualCircle() { alert("Нарисован ритуальный круг"); }
        function voidScan() { alert("Начато сканирование пустоты"); }
        function purgeSystems() { alert("Системы продувки активированы"); }
        function releaseZ9() { alert("Выпущены образцы Z9!"); }
        function showFinalMessage() { 
            const output = document.getElementById('command-output');
            output.innerHTML += `<div class="text-red-400">FINAL MESSAGE: "Это конец... они вырвались..."</div>`;
            output.scrollTop = output.scrollHeight;
        }

        // Developer function to export all user data
        function exportAllData() {
            const output = document.getElementById('command-output');
            const allAgents = Object.keys(agentCodes).map(id => ({
                id,
                name: agentCodes[id].name,
                access: agentCodes[id].access
            }));
            
            // In a real system this would send to server
            output.innerHTML += `
                <div class="text-green-400">ЭКСПОРТ ДАННЫХ:</div>
                <div class="text-xs mt-2">
                    ${JSON.stringify(allAgents, null, 2).replace(/\n/g, '<br>').replace(/ /g, '&nbsp;')}
                </div>
                <div class="text-yellow-400 mt-2">Данные готовы к передаче на сервер</div>
            `;
            output.scrollTop = output.scrollHeight;
            
            // Simulate server upload
            setTimeout(() => {
                output.innerHTML += `<div class="text-green-400">Данные успешно переданы на сервер</div>`;
                output.scrollTop = output.scrollHeight;
            }, 2000);
        }

        // Chat functions with auto-responses
        let messageCounts = {};
        let activeChats = {};
        let currentAgent = null;
        
        function sendChatMessage() {
            const recipient = document.getElementById('chat-recipient').value;
            const message = document.getElementById('chat-message').value;
            const chatMessages = document.getElementById('chat-messages');
            
            if (!recipient) {
                alert('Выберите получателя');
                return;
            }
            
            if (!message) {
                alert('Введите сообщение');
                return;
            }
            
            const agent = agentCodes[recipient];
            
            // Check if blocked
            if (agent.blocked) {
                chatMessages.innerHTML += `<div class="text-red-400 mb-1">${agent.blockMessage}</div>`;
                chatMessages.scrollTop = chatMessages.scrollHeight;
                document.getElementById('chat-message').value = '';
                return;
            }
            
            // Track message count
            if (!messageCounts[recipient]) {
                messageCounts[recipient] = 0;
            }
            messageCounts[recipient]++;
            
            // Add user message
            chatMessages.innerHTML += `<div class="text-right mb-1"><span class="bg-green-900 bg-opacity-50 p-1 rounded">Вы: ${message}</span></div>`;
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Process agent response
            processAgentResponse(recipient, message);
            
            document.getElementById('chat-message').value = '';
        }

        function processAgentResponse(recipient, message) {
            const chatMessages = document.getElementById('chat-messages');
            const agent = agentCodes[recipient];
            
            // Add typing indicator
            chatMessages.innerHTML += `<div class="text-left mb-1 text-gray-400" id="typing-indicator">${agent.name} печатает...</div>`;
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Generate contextual response
            let response;
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('привет') || lowerMessage.includes('здравствуй')) {
                response = `${agent.name}: Приветствую. ${agent.responses[0]}`;
            } 
            else if (lowerMessage.includes('статус') || lowerMessage.includes('ситуация')) {
                response = `${agent.name}: Текущий статус: ${agent.responses[1] || agent.responses[0]}`;
            } 
            else if (lowerMessage.includes('помощь') || lowerMessage.includes('поддержка')) {
                response = `${agent.name}: ${agent.responses[2] || 'Я не могу вам помочь в данный момент.'}`;
            }
            else if (lowerMessage.includes('z9') || lowerMessage.includes('заражен')) {
                response = `${agent.name}: ${agent.name === 'Тоша (Заражённый)' ? 
                    'Они уже внутри меня...' : 
                    'Образцы Z9 демонстрируют аномальную активность!'}`;
            }
            else if (lowerMessage.includes('код') || lowerMessage.includes('пароль')) {
                response = `${agent.name}: ${agent.isDeveloper ? 
                    'Код доступа: DEV-ACCESS-777' : 
                    'Я не могу разглашать коды доступа.'}`;
            }
            else {
                const randomResponse = agent.responses[Math.floor(Math.random() * agent.responses.length)];
                response = `${agent.name}: ${randomResponse}`;
            }
            
            // Simulate typing delay (1.5-3.5 seconds)
            setTimeout(() => {
                document.getElementById('typing-indicator').remove();
                chatMessages.innerHTML += `<div class="text-left mb-1"><span class="bg-blue-900 bg-opacity-50 p-1 rounded">${response}</span></div>`;
                
                // Check if should block after certain messages
                if (agent.blockAfter && messageCounts[recipient] >= agent.blockAfter) {
                    agent.blocked = true;
                    setTimeout(() => {
                        chatMessages.innerHTML += `<div class="text-red-400 mb-1">${agent.blockMessage}</div>`;
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 1500);
                }
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Special case for infected Toha
                if (recipient === 'TOCHA-MK' && Math.random() > 0.7) {
                    setTimeout(() => {
                        chatMessages.innerHTML += `<div class="text-left mb-1"><span class="bg-red-900 bg-opacity-50 p-1 rounded">Тоша (Заражённый): *неразборчивые звуки*</span></div>`;
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 2000);
                }
            }, 1500 + Math.random() * 2000);
        }

        // Initialize chat when recipient selected
        document.getElementById('chat-recipient').addEventListener('change', function() {
            const recipient = this.value;
            const chatMessages = document.getElementById('chat-messages');
            
            if (recipient) {
                const agent = agentCodes[recipient];
                currentAgent = recipient;
                
                if (agent.blocked) {
                    chatMessages.innerHTML = `<div class="text-red-400">${agent.blockMessage}</div>`;
                    return;
                }
                
                chatMessages.innerHTML = `<div class="text-gray-400">Установлено соединение с ${agent.name}</div>`;
                
                // Auto greeting from agent
                if (!activeChats[recipient]) {
                    setTimeout(() => {
                        const greeting = `${agent.name}: ${agent.responses[0]}`;
                        chatMessages.innerHTML += `<div class="text-left mb-1"><span class="bg-blue-900 bg-opacity-50 p-1 rounded">${greeting}</span></div>`;
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                        
                        // Special initial message for some agents
                        if (recipient === 'TOCHA-MK') {
                            setTimeout(() => {
                                chatMessages.innerHTML += `<div class="text-left mb-1"><span class="bg-red-900 bg-opacity-50 p-1 rounded">Тоша (Заражённый): *странные звуки*</span></div>`;
                                chatMessages.scrollTop = chatMessages.scrollHeight;
                            }, 2000);
                        }
                    }, 1000);
                    activeChats[recipient] = true;
                }
            } else {
                currentAgent = null;
                chatMessages.innerHTML = '';
            }
        });

        // Handle recipient change
        document.getElementById('chat-recipient').addEventListener('change', function() {
            const recipient = this.value;
            if (recipient) {
                const agent = agentCodes[recipient];
                if (agent.blocked) {
                    document.getElementById('chat-messages').innerHTML = 
                        `<div class="text-red-400">${agent.blockMessage}</div>`;
                } else {
                    document.getElementById('chat-messages').innerHTML = 
                        `<div class="text-gray-400">Connected to ${agent.name}</div>`;
                }
            } else {
                document.getElementById('chat-messages').innerHTML = '';
            }
        });

        // Allow pressing Enter in chat
        document.getElementById('chat-message').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });

        // Auto-focus message input when recipient selected
        document.getElementById('chat-recipient').addEventListener('change', function() {
            if (this.value) {
                document.getElementById('chat-message').focus();
            }
        });

        // Initialize
        window.onload = function() {
            createParticles();
            createDNAStrand();
            
            // Display daily code hint
            setTimeout(() => {
                const output = document.getElementById('command-output');
                output.innerHTML += `<div class="text-yellow-400">System hint: Today's code prefix is ${generateDailyCode()}</div>`;
                output.scrollTop = output.scrollHeight;
            }, 3000);
        };
    </script>
</body>
</html>
